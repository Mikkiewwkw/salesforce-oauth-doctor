<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OAuth Doctor - Test Page</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      line-height: 1.6;
    }
    h1 {
      color: #667eea;
      border-bottom: 3px solid #764ba2;
      padding-bottom: 10px;
    }
    .test-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      border-left: 4px solid #667eea;
    }
    .test-section h2 {
      margin-top: 0;
      color: #333;
    }
    .test-links {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .test-link {
      background: white;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid #ddd;
      text-decoration: none;
      color: #333;
      transition: all 0.2s;
    }
    .test-link:hover {
      border-color: #667eea;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
      transform: translateY(-2px);
    }
    .test-link strong {
      color: #667eea;
      display: block;
      margin-bottom: 5px;
    }
    .test-link code {
      background: #f8f9fa;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 12px;
      color: #dc3545;
    }
    .instructions {
      background: #fff3cd;
      padding: 15px;
      border-radius: 6px;
      border: 1px solid #ffc107;
      margin: 20px 0;
    }
    .success {
      background: #d4edda;
      border-color: #28a745;
    }
    .note {
      font-size: 14px;
      color: #666;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h1>ðŸ©º OAuth Doctor - Test Page</h1>
  
  <div class="instructions success">
    <strong>âœ“ Extension Installation Test</strong>
    <p>If you can see this page, the extension is loaded. Now test the functionality below!</p>
  </div>

  <div class="test-section">
    <h2>Test 1: OAuth Error Detection</h2>
    <p>These links simulate OAuth errors. Click them to see OAuth Doctor diagnose the problem:</p>
    <div class="test-links">
      <a href="?error=redirect_uri_mismatch&error_description=redirect_uri%20must%20match%20configuration" class="test-link">
        <strong>Redirect URI Mismatch</strong>
        <span>Most common OAuth configuration error</span>
        <code>error=redirect_uri_mismatch</code>
      </a>
      
      <a href="?error=invalid_client_id&error_description=client%20identifier%20invalid" class="test-link">
        <strong>Invalid Client ID</strong>
        <span>Consumer Key is incorrect or doesn't exist</span>
        <code>error=invalid_client_id</code>
      </a>
      
      <a href="?error=invalid_grant&error_description=authentication%20failure" class="test-link">
        <strong>Invalid Grant</strong>
        <span>Authorization code expired or already used</span>
        <code>error=invalid_grant</code>
      </a>
      
      <a href="?error=access_denied&error_description=user%20denied%20authorization" class="test-link">
        <strong>Access Denied</strong>
        <span>User clicked "Deny" on authorization page</span>
        <code>error=access_denied</code>
      </a>
      
      <a href="?error=invalid_scope&error_description=requested%20scope%20is%20invalid" class="test-link">
        <strong>Invalid Scope</strong>
        <span>One or more requested scopes are not allowed</span>
        <code>error=invalid_scope</code>
      </a>
    </div>
  </div>

  <div class="test-section">
    <h2>Test 2: OAuth Scope Analysis</h2>
    <p>Click the link below to test scope analysis with various permission levels:</p>
    <div class="test-links">
      <a href="?scope=full+refresh_token+api+openid+email&client_id=test_client" class="test-link">
        <strong>Test Multiple Scopes</strong>
        <span>Includes high-risk (full), medium (api), and low-risk (openid, email) scopes</span>
        <code>scope=full refresh_token api openid email</code>
      </a>
      
      <a href="?scope=full+web+offline_access&client_id=dangerous_app" class="test-link">
        <strong>Test High-Risk Scopes</strong>
        <span>All dangerous permissions - should trigger security warning</span>
        <code>scope=full web offline_access</code>
      </a>
      
      <a href="?scope=api+chatter_api+content&client_id=medium_app" class="test-link">
        <strong>Test Medium-Risk Scopes</strong>
        <span>Standard API access scopes</span>
        <code>scope=api chatter_api content</code>
      </a>
      
      <a href="?scope=openid+profile+email+id&client_id=safe_app" class="test-link">
        <strong>Test Low-Risk Scopes</strong>
        <span>Safe, read-only permissions</span>
        <code>scope=openid profile email id</code>
      </a>
    </div>
    <p class="note" style="margin-top: 10px;">
      Click any link above, then the OAuth Doctor overlay should appear automatically analyzing the scopes!
    </p>
  </div>

  <div class="test-section">
    <h2>Test 3: Real Salesforce OAuth Flow</h2>
    <p>To test with a real Salesforce OAuth flow:</p>
    <ol>
      <li>Create a Connected App in Salesforce (Setup â†’ App Manager â†’ New Connected App)</li>
      <li>Enable OAuth Settings</li>
      <li>Add callback URL: <code>https://example.com</code></li>
      <li>Select some OAuth scopes</li>
      <li>Use this URL template with your Consumer Key:</li>
    </ol>
    <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; font-family: monospace; font-size: 12px; overflow-x: auto; margin-top: 10px;">
      https://login.salesforce.com/services/oauth2/authorize?client_id=YOUR_CONSUMER_KEY&redirect_uri=https://example.com&response_type=code&scope=api%20refresh_token%20full%20openid%20email
    </div>
    <p class="note" style="margin-top: 10px;">
      Replace YOUR_CONSUMER_KEY with your actual Consumer Key from the Connected App.
    </p>
  </div>

  <div class="instructions">
    <strong>ðŸ’¡ Testing Tips</strong>
    <ul style="margin: 10px 0 0 0; padding-left: 20px;">
      <li>Open browser console (F12) to see OAuth Doctor logs</li>
      <li>The extension automatically detects OAuth pages and errors</li>
      <li>You can also manually trigger analysis from the extension popup</li>
      <li>Try different combinations of scopes and errors</li>
    </ul>
  </div>

  <div class="test-section">
    <h2>Expected Behavior</h2>
    <ul>
      <li>âœ… <strong>Error pages:</strong> Overlay appears immediately showing error diagnosis</li>
      <li>âœ… <strong>Authorization pages:</strong> Overlay shows scope analysis with risk levels</li>
      <li>âœ… <strong>High-risk scopes:</strong> Warning banner appears for dangerous permissions</li>
      <li>âœ… <strong>Color coding:</strong> Scopes are color-coded by risk (red = high, green = low)</li>
      <li>âœ… <strong>Fix instructions:</strong> Step-by-step solutions for each error</li>
    </ul>
  </div>

  <footer style="margin-top: 50px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; color: #666;">
    <p>OAuth Doctor v1.0.0 | Built for Salesforce Developers</p>
  </footer>

  <script>
    // Add visual feedback when extension analyzes the page
    console.log('OAuth Doctor Test Page Loaded');
    console.log('Current URL:', window.location.href);
    
    // Check for OAuth errors in URL
    const urlParams = new URLSearchParams(window.location.search);
    const error = urlParams.get('error');
    if (error) {
      console.log('OAuth Error Detected:', error);
      console.log('Error Description:', urlParams.get('error_description'));
    }
  </script>
</body>
</html>

